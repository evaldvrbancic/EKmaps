<template>
  <div class="page" data-name="home">
    <!-- Top Navbar -->
    <div class="navbar navbar-large">
      <div class="navbar-bg"></div>
      <div class="navbar-inner">
        <div class="left">
          <a href="#" class="link icon-only panel-open" data-panel="left">
            <i class="icon f7-icons if-not-md">menu</i>
            <i class="icon material-icons if-md">menu</i>
          </a>
        </div>
        <div class="title sliding">EK maps</div>
        <div class="right">
          <a href="#" class="link icon-only panel-open" data-panel="right">
            <i class="icon f7-icons if-not-md">menu</i>
            <i class="icon material-icons if-md">chat_bubble_2_fill</i>
          </a>
        </div>
        <div class="title-large navbar-border">
          <div class="title-large-text">EK maps</div>
        </div>
      </div>
    </div>
    <!-- Toolbar-->
    <div class="toolbar toolbar-bottom toolbar-border">
      <div class="toolbar-inner">
        <a href="#" class="link">
          <!--Left Link-->
        </a>
        <a href="#" class="link">
          <!--Right Link-->
        </a>
      </div>
    </div>
    <!-- Scrollable page content-->
    <div class="page-content">
      <div class="map-container">
        <div id="map" class="map">
          <div id="popup"></div>
        </div>
      </div>








      <script type="text/javascript">
        var mode = 1;
        var userLonLat = new Array(2);
        var startLocation = '';

        var stylePoly = new ol.style.Style({
          fill: new ol.style.Fill({
            color: 'rgba(20, 100, 240, 0.2)'
          }),
          stroke: new ol.style.Stroke({
            width: 3,
            color: 'rgba(0, 100, 240, 0.5)'
          }),
          image: new ol.style.Circle({
            fill: new ol.style.Fill({
              color: 'rgba(55, 200, 150, 0.4)'
            }),
            stroke: new ol.style.Stroke({
              width: 10,
              color: 'rgba(55, 200, 150, 0.5)'
            }),
            radius: 7
          }),
        });

        var points = [],
          msg_el = document.getElementById('msg'),
          url_osrm_nearest = '//router.project-osrm.org/nearest/v1/driving/',
          url_osrm_route = '//router.project-osrm.org/route/v1/driving/',
          icon_url = 'https://i.imgur.com/IJk2Rj3.png',

          vectorSource = new ol.source.Vector(),
          vectorSource2 = new ol.source.Vector(),
          vectorSourcePoly = new ol.source.Vector(),

          vectorLayer = new ol.layer.Vector({
            source: vectorSource
          }),
          vectorUserLocation = new ol.layer.Vector({
            source: vectorSource2
          }),
          vectorPoly = new ol.layer.Vector({
            source: vectorSourcePoly,
            style: stylePoly
          }),

          styles = {
            route: new ol.style.Style({
              stroke: new ol.style.Stroke({
                width: 6, color: [40, 40, 40, 0.8]
              })
            }),
            icon: new ol.style.Style({
              image: new ol.style.Icon({
                anchor: [0.5, 1],
                src: icon_url,
                scale: 0.08
              })
            })
          };

        console.clear();

        /*var featureTe = new ol.Feature({
          type: 'place',
          geometry: new ol.geom.Polygon([[[15.5201295, 46.6215512], [15.5201939, 46.6215771], [15.52033, 46.6216589], [15.52048, 46.6217623], [15.5205809, 46.6219206], [15.5205927, 46.6219532], [15.520631, 46.6219669], [15.5208428, 46.6219604], [15.520977, 46.6219672], [15.5210805, 46.622023], [15.5211587, 46.6220862], [15.521183, 46.6221409], [15.5212642, 46.6223058], [15.5215112, 46.6224037], [15.5216684, 46.6224345], [15.5219037, 46.6225647], [15.5220547, 46.6226093], [15.5223279, 46.6227057], [15.5224421, 46.6227592], [15.5226239, 46.6228579], [15.5226643, 46.6229035], [15.5227625, 46.6230257], [15.5228694, 46.6230693], [15.5229223, 46.6231666], [15.5229009, 46.6232356], [15.5230277, 46.6234385], [15.5230743, 46.6234703], [15.5231163, 46.6235916], [15.523173, 46.6236567], [15.5232508, 46.6237612], [15.5232431, 46.6238008], [15.5232844, 46.6238445], [15.5233666, 46.6240154], [15.5233542, 46.6240846], [15.5233857, 46.6241908], [15.5234221, 46.6242685], [15.5234143, 46.6243025], [15.5232749, 46.6243503], [15.5232956, 46.624418], [15.5234079, 46.6244757], [15.5237694, 46.6244289], [15.5238366, 46.6244487],
          [15.5238092, 46.6245843], [15.5239521, 46.6247348], [15.5240794, 46.6248694], [15.5242235, 46.6249129], [15.5242333, 46.6250289], [15.5243001, 46.6251771], [15.5243637, 46.6252847], [15.5244159, 46.6255115], [15.5244633, 46.6255942], [15.5246232, 46.6257259], [15.5249595, 46.6258623], [15.5251143, 46.6260152], [15.5253061, 46.6260991], [15.525365, 46.6261474], [15.5254566, 46.6263126], [15.5255281, 46.626521], [15.5256391, 46.6266397], [15.5258426, 46.6267089], [15.5260733, 46.6266628], [15.5262145, 46.6266886], [15.5263728, 46.6268087], [15.5265827, 46.6269147], [15.5270269, 46.62731], [15.5271155, 46.6273713], [15.5273967, 46.6274213], [15.5274702, 46.627455], [15.5276173, 46.6275164], [15.5277166, 46.6275411], [15.5278017, 46.627558], [15.5281387, 46.6279361], [15.5283027, 46.6280643], [15.5284592, 46.6280891], [15.5286735, 46.6279787], [15.5288456, 46.6279875], [15.5289023, 46.628014], [15.5290771, 46.6281441], [15.5295499, 46.6282996], [15.5295827, 46.6283145], [15.5296248, 46.6283704], [15.5297131, 46.6285889], [15.5299026, 46.6287259], [15.5299553, 46.6287722], [15.5300119, 46.6287988], [15.5301909, 46.6288484],
          [15.5302129, 46.6288559], [15.5302479, 46.6289523], [15.5301023, 46.6291873], [15.5300219, 46.6296986], [15.5300494, 46.6297863], [15.5301108, 46.6298582], [15.5301408, 46.6299637], [15.5301478, 46.6299774], [15.5302701, 46.630099], [15.5302893, 46.6301174], [15.5304025, 46.6301845], [15.5304329, 46.6301906], [15.5307646, 46.6302019], [15.5309733, 46.6302978], [15.5310638, 46.6303754], [15.531083, 46.6304108], [15.5311843, 46.6305316], [15.5312759, 46.6305959], [15.531473, 46.630777], [15.5315046, 46.6308099], [15.5317026, 46.6309199], [15.5318154, 46.6309598], [15.5319052, 46.6309881], [15.5319787, 46.6310004], [15.5320776, 46.6310407], [15.5321301, 46.6310684], [15.5321529, 46.6310846], [15.5322682, 46.6311128], [15.5324225, 46.6310807], [15.5325097, 46.6310735], [15.5327883, 46.6311075], [15.5330805, 46.6311321], [15.5335306, 46.6311874], [15.5336958, 46.631253], [15.5338522, 46.6313279], [15.5338731, 46.6313475], [15.533972, 46.6315325], [15.5339663, 46.6316171], [15.5339293, 46.6316877], [15.5338617, 46.6319767], [15.5338788, 46.6320569], [15.5339046, 46.6321378], [15.5340135, 46.632227], [15.5340442, 46.6322595],
          [15.5340946, 46.6322732], [15.5341268, 46.6322655], [15.5342252, 46.6322318], [15.5343981, 46.6321269], [15.5345438, 46.6321443], [15.5346611, 46.63222], [15.5347481, 46.6322617], [15.5348297, 46.6323009], [15.534957, 46.6323898], [15.5350933, 46.6324124], [15.5352003, 46.6324661], [15.5353197, 46.6325817], [15.5353873, 46.6326215], [15.5354969, 46.6327559], [15.5355094, 46.632835], [15.535596, 46.6329038], [15.5356979, 46.6329389], [15.5359523, 46.6332559], [15.5360648, 46.6333692], [15.5361294, 46.6334125], [15.5362248, 46.633449], [15.5362708, 46.6334612], [15.536392, 46.633435], [15.5366742, 46.6334968], [15.5367673, 46.6335233], [15.53695, 46.6336053], [15.5370253, 46.6336689], [15.5370175, 46.6338082], [15.5371088, 46.6339155], [15.5372793, 46.6337717], [15.537365, 46.6337416], [15.537543, 46.6339213], [15.5377194, 46.6340628], [15.5377687, 46.6340883], [15.5378048, 46.634081], [15.5379642, 46.6339502], [15.538024, 46.6339604], [15.5380687, 46.6339769], [15.5382292, 46.6340921], [15.5382957, 46.6341329], [15.5385304, 46.634155], [15.5387796, 46.634284], [15.5388123, 46.6342916], [15.5389708, 46.6342049],
          [15.5391417, 46.6341889], [15.5392839, 46.6341735], [15.5394798, 46.6341421], [15.5395987, 46.6340481], [15.5397616, 46.6339332], [15.5399527, 46.63385], [15.540063, 46.6338092], [15.5402209, 46.6337867], [15.540407, 46.6338242], [15.5405633, 46.633859], [15.5406775, 46.633838], [15.5407148, 46.6336367], [15.5407826, 46.6334487], [15.5408136, 46.633388], [15.5410187, 46.6333015], [15.5411522, 46.6332441], [15.5412763, 46.6330895], [15.5412467, 46.6329954], [15.5411811, 46.6328662], [15.5411415, 46.632708], [15.5411735, 46.6326427], [15.5416427, 46.6325031], [15.5416682, 46.6324508], [15.5416432, 46.6323704], [15.541521, 46.6322456], [15.5414851, 46.6322347], [15.5414119, 46.6321276], [15.5414473, 46.6320579], [15.5417205, 46.6318771], [15.5417467, 46.6317539], [15.5418018, 46.6315774], [15.5418303, 46.6314659], [15.5418362, 46.6313779], [15.5418104, 46.6311883], [15.5419032, 46.6311412], [15.5419485, 46.6310807], [15.5419597, 46.6310243], [15.5419478, 46.6307565], [15.5421137, 46.6305136], [15.5421587, 46.6304556], [15.5421651, 46.630351], [15.5421389, 46.6302051], [15.5421554, 46.6301045], [15.542347, 46.6299819],
          [15.5424423, 46.6299516], [15.5428813, 46.6298772], [15.5434925, 46.6296134], [15.5437413, 46.6296752], [15.5439233, 46.6295933], [15.544207, 46.6292321], [15.5450677, 46.629111], [15.5454755, 46.629406], [15.5458146, 46.6293594], [15.5462815, 46.6290422], [15.546854, 46.6288326], [15.5472168, 46.6285429], [15.5477126, 46.6285046], [15.5481703, 46.6285653], [15.548483, 46.6284919], [15.5486121, 46.6283473], [15.5485044, 46.6280239], [15.5487514, 46.6279148], [15.5493902, 46.6278037], [15.5497954, 46.6278378], [15.5501114, 46.6280972], [15.5504124, 46.6281587], [15.5505848, 46.6284188], [15.5508602, 46.6285254], [15.5515516, 46.6284501], [15.5518764, 46.6282866], [15.552437, 46.6281939], [15.5532039, 46.6278393], [15.5534648, 46.627811], [15.5542779, 46.628149], [15.5546877, 46.6286328], [15.5550389, 46.6284961], [15.5560736, 46.628788], [15.5562316, 46.6289132], [15.5563666, 46.6293444], [15.5568542, 46.6297738], [15.5574004, 46.6305701], [15.55841, 46.6299282], [15.5594323, 46.6290235], [15.5596971, 46.6281045], [15.5601907, 46.6278502], [15.5606629, 46.6267862], [15.5614598, 46.6268183], [15.5619179, 46.626915],
          [15.5637192, 46.6268341], [15.5645111, 46.6276399], [15.565308, 46.627663], [15.566075, 46.6273353], [15.5662235, 46.6265428], [15.5666548, 46.6253351], [15.5694568, 46.6260409], [15.5696167, 46.626346], [15.5699188, 46.6265064], [15.5711068, 46.6264735], [15.5715229, 46.6263095], [15.5722949, 46.6264495], [15.5730832, 46.6268954], [15.5736322, 46.6269466], [15.5741539, 46.626881], [15.5745833, 46.6267349], [15.5751155, 46.6264353], [15.5751012, 46.6263185], [15.575371, 46.6259032], [15.5756302, 46.625713], [15.5784109, 46.625636], [15.5796401, 46.6257917], [15.5811845, 46.6261167], [15.5819709, 46.6263826], [15.5820896, 46.6264899], [15.5821714, 46.6268134], [15.5826312, 46.6270719], [15.5832024, 46.6279597], [15.5838996, 46.628433], [15.5847644, 46.629904], [15.5852124, 46.6302706], [15.5861428, 46.6307148], [15.5868745, 46.6293894], [15.5885853, 46.6293895], [15.5892392, 46.6294761], [15.5906403, 46.6298197], [15.5909198, 46.6290986], [15.5912932, 46.6286108], [15.5919016, 46.6281218], [15.5922532, 46.62803], [15.5947988, 46.6279358], [15.5949225, 46.628502], [15.5951341, 46.6287438], [15.5964374, 46.6296816], [15.5973091, 46.6282016], [15.5982571, 46.6277198], [15.5994796, 46.6272635], [15.6000766, 46.6269275], [15.6012897, 46.6256256], [15.600616, 46.6249274], [15.6005072, 46.6245411], [15.6007901, 46.6241437], [15.6016504, 46.6240043], [15.6032309, 46.623098], [15.6029198, 46.6230799], [15.6028403, 46.6229723], [15.6022512, 46.6228405], [15.6021065, 46.6227423], [15.6021693, 46.6225261], [15.6016451, 46.6223579], [15.6014501, 46.6212523], [15.601251, 46.6209655], [15.6011944, 46.6205699], [15.6015802, 46.6188675], [15.6017325, 46.6184708], [15.6023521, 46.6178288], [15.6026407, 46.6179442], [15.603699, 46.6180106], [15.6041835, 46.618134], [15.6046735, 46.6187521], [15.6048308, 46.6188053], [15.6051832, 46.6187944], [15.6058122, 46.618998], [15.6075376, 46.6191598], [15.6092998, 46.620275], [15.6099299, 46.6205685], [15.6104135, 46.6206109], [15.6106345, 46.6205287], [15.6113582, 46.6198591], [15.6114971, 46.6194445], [15.6120891, 46.6186766], [15.6124144, 46.6185759], [15.6128173, 46.6172602], [15.6136435, 46.616428], [15.6141492, 46.6161194], [15.6142113, 46.6158402], [15.6150079, 46.6158539], [15.6154363, 46.6156357], [15.6159699, 46.6154798], [15.6166222, 46.6154403], [15.6169853, 46.6152224], [15.6173973, 46.6147164], [15.6198717, 46.6130206], [15.6204435, 46.6127925], [15.6208485, 46.6128173], [15.6211742, 46.6127526], [15.6213948, 46.6126344], [15.6218075, 46.6122003], [15.6220422, 46.6121721], [15.6222989, 46.6117838], [15.623864, 46.6116493], [15.6242152, 46.6115394], [15.624398, 46.6115384], [15.6248569, 46.6117068], [15.625183, 46.611687], [15.6259876, 46.6114031], [15.6259716, 46.611017], [15.6263573, 46.610502], [15.6265906, 46.6103478], [15.626864, 46.6102833], [15.6277434, 46.6095677], [15.6285238, 46.6093205], [15.6288716, 46.6089137], [15.6291706, 46.6088041], [15.6299396, 46.6087009], [15.6313756, 46.608702], [15.6317277, 46.608799], [15.6311436, 46.6078306], [15.6295901, 46.6067056], [15.629271, 46.6062125], [15.62919, 46.605979], [15.6292522, 46.6057178], [15.6296375, 46.6051669], [15.6296061, 46.6047172], [15.6292956, 46.6038282], [15.6289401, 46.6035693], [15.6286479, 46.603139], [15.6287085, 46.6027338], [15.6284018, 46.6021777], [15.6285024, 46.6018443], [15.6281613, 46.6016932], [15.628029, 46.601541], [15.6279504, 46.6003898], [15.6273042, 46.598693], [15.6271912, 46.5979559], [15.6284167, 46.5978322], [15.630796, 46.5981609], [15.6313932, 46.5978877], [15.6327456, 46.5974574], [15.6338945, 46.597487], [15.6347315, 46.5970964], [15.6355306, 46.5962373], [15.6373592, 46.5957673], [15.6377482, 46.5955492], [15.6382129, 46.5951147], [15.639264, 46.594596], [15.6399011, 46.5943945], [15.6411847, 46.5942337], [15.6425187, 46.593912], [15.6428928, 46.593541], [15.6443482, 46.593011], [15.6454507, 46.5924379], [15.646165, 46.5923503], [15.6468054, 46.5922233], [15.6477597, 46.5923529], [15.6483326, 46.5922417], [15.6487772, 46.5923201], [15.6495117, 46.5926218], [15.65023, 46.5926627], [15.6508713, 46.592812], [15.6509512, 46.5929465], [15.6515422, 46.593258], [15.6520008, 46.5934083], [15.6523795, 46.5934242], [15.6528357, 46.5933766], [15.6530801, 46.5930783], [15.6534823, 46.592887], [15.6542367, 46.5926758], [15.6546286, 46.5927005], [15.6554355, 46.5925159], [15.6560095, 46.5924947], [15.6561652, 46.5924218], [15.6562029, 46.5923046], [15.6581144, 46.593877], [15.6586776, 46.5940447], [15.6595775, 46.5939945], [15.6598528, 46.5940919], [15.6609979, 46.594886], [15.6635813, 46.594817], [15.6643238, 46.5947047], [15.6652455, 46.5953651], [15.6659968, 46.5949019], [15.6662067, 46.5949907], [15.6668541, 46.594564], [15.66777, 46.593695], [15.6680876, 46.5929914], [15.6691022, 46.5937771], [15.6695255, 46.5942335], [15.6703402, 46.5946785], [15.6708645, 46.5948644], [15.6721319, 46.5949739], [15.6722385, 46.5951532], [15.6743964, 46.5955093], [15.6750384, 46.5957035], [15.6758845, 46.5954368], [15.6763509, 46.5952738], [15.6773859, 46.5947679], [15.678647, 46.5943098], [15.6796636, 46.5940206], [15.6810915, 46.5934003], [15.6813766, 46.5932456], [15.6817718, 46.5928642], [15.6822019, 46.592449], [15.6829078, 46.5925437], [15.6832888, 46.5927394], [15.6836549, 46.5928002], [15.6851493, 46.593322], [15.6849242, 46.5920278], [15.6849655, 46.5911639], [15.6864311, 46.5894187], [15.6871189, 46.588083], [15.6865882, 46.5873934], [15.6861616, 46.5870093], [15.6853025, 46.5868524], [15.6844641, 46.5865965], [15.6841307, 46.5860317], [15.6840987, 46.585564], [15.6846883, 46.5847148], [15.6850898, 46.5834438], [15.6855481, 46.5825414], [15.6855457, 46.5813178], [15.685457, 46.5811699], [15.6851756, 46.5810331],
          [15.6845219, 46.5808382], [15.6839541, 46.5802734], [15.6835509, 46.5800166], [15.6831703, 46.5798664], [15.6827083, 46.5798054], [15.6821344, 46.5798268], [15.6815279, 46.5800356], [15.6820647, 46.5794674], [15.682598, 46.5793382], [15.6836185, 46.5785224], [15.6853167, 46.5776485], [15.6879939, 46.5768227], [15.688333, 46.5768116], [15.6886081, 46.5768999], [15.6893206, 46.5775254], [15.6898184, 46.5776843], [15.690429, 46.5774737], [15.6910887, 46.5770289], [15.6936583, 46.5769773], [15.693814, 46.5769044], [15.6939158, 46.5767058], [15.6938994, 46.576445], [15.6936989, 46.5760684], [15.6937992, 46.5757529], [15.6945514, 46.5753974], [15.6949245, 46.5749903], [15.6952561, 46.5743945], [15.6967521, 46.5730358], [15.697193, 46.5728352], [15.6976746, 46.5727423], [15.6989082, 46.5722939], [15.6995139, 46.5721157], [15.700026, 46.5719721], [15.7003076, 46.5719249], [15.7006254, 46.5719235], [15.701327, 46.5719694], [15.7018273, 46.572051], [15.70197, 46.5719872], [15.702019, 46.5714668], [15.7021397, 46.5709875], [15.7024986, 46.5700952], [15.7040242, 46.5708183], [15.7047492, 46.5710164], [15.7059621, 46.5709909], [15.7064039, 46.5708532], [15.7073819, 46.5708202], [15.7081999, 46.5705272], [15.7095156, 46.570384], [15.7103927, 46.5706125], [15.7107123, 46.5701157], [15.7114142, 46.569495], [15.7152645, 46.5670913], [15.7156501, 46.566657], [15.7184478, 46.5641653], [15.7186913, 46.5638399], [15.719133, 46.5637021], [15.7199014, 46.5636163], [15.720168, 46.5630658], [15.7209823, 46.5625029], [15.7210374, 46.5617378], [15.7211654, 46.561557], [15.7225395, 46.5609186], [15.7230925, 46.5603303], [15.7234188, 46.5603462], [15.7245762, 46.5600869], [15.725459, 46.5597754], [15.7255292, 46.5601529], [15.7253698, 46.5609096], [15.7256581, 46.5610157], [15.7258274, 46.5609967], [15.725816, 46.5611137], [15.7264846, 46.5613703], [15.7292124, 46.5614969], [15.7300833, 46.5622471], [15.7314877, 46.5628948], [15.7320055, 46.5635663], [15.7320666, 46.5642317], [15.7322544, 46.5646173], [15.7324658, 46.5648139], [15.7332409, 46.5652228], [15.7336003, 46.5657513], [15.7343618, 46.5661153], [15.7348646, 46.5656802], [15.7353369, 46.5658751], [15.7357046, 46.5660616], [15.7357328, 46.5662144], [15.7361522, 46.5663646], [15.7370336, 46.5669078], [15.7375238, 46.5674624], [15.7384569, 46.5679692], [15.7388016, 46.5683808], [15.7409012, 46.5683312], [15.7411371, 46.5684106], [15.7415858, 46.5687856], [15.7449956, 46.5691502], [15.7457987, 46.5687401], [15.746843, 46.5678426], [15.7480349, 46.5691394], [15.7482984, 46.5693266], [15.7482511, 46.5696778], [15.7488604, 46.5703485], [15.748705, 46.5704305], [15.7497822, 46.5709722], [15.7497082, 46.5712786], [15.7507501, 46.5711548], [15.7518194, 46.5711208], [15.7528089, 46.5709793], [15.7526716, 46.5704854], [15.7527724, 46.5702238], [15.7529664, 46.5701056], [15.7536059, 46.5701283], [15.7544348, 46.569691], [15.7550221, 46.5697141], [15.7556012, 46.5691435], [15.756131, 46.5687801], [15.7563919, 46.5678427], [15.7562469, 46.5677357], [15.7556987, 46.5677123], [15.7555392, 46.5674975], [15.7553041, 46.567481], [15.7552897, 46.5673822], [15.7555472, 46.5671375], [15.755963, 46.5670178], [15.755972, 46.5667299], [15.7566554, 46.5661585], [15.7569802, 46.5660664], [15.7575805, 46.5660804], [15.7577583, 46.5657374], [15.7579266, 46.5656463], [15.7579611, 46.5653132], [15.7585082, 46.5652555], [15.7587969, 46.5653796], [15.7593683, 46.5651958], [15.7596395, 46.5650051], [15.7597004, 46.5646988], [15.7596195, 46.5645104], [15.7590283, 46.5642084], [15.7593233, 46.5638466], [15.7597015, 46.5629084], [15.7600909, 46.5627709], [15.759809, 46.5622059], [15.7600151, 46.5620156], [15.760944, 46.5622164], [15.7615829, 46.5622031], [15.7615551, 46.5620773], [15.7619163, 46.561796], [15.7620241, 46.5611115], [15.7621271, 46.5610119], [15.7635256, 46.5612185], [15.7640584, 46.5610799], [15.7646794, 46.5607159], [15.7654856, 46.5605396], [15.7662376, 46.5602196], [15.7665892, 46.5601813], [15.7673737, 46.56032], [15.7683192, 46.5607724], [15.7688094, 46.5608493], [15.7697929, 46.5607588], [15.7708409, 46.5607914], [15.7708132, 46.5608538], [15.7715937, 46.5610967], [15.772185, 46.5614084], [15.7722677, 46.5613208], [15.7702641, 46.5580063], [15.7718887, 46.5577127], [15.7706852, 46.5565369], [15.7695249, 46.5565718], [15.7694098, 46.5548901], [15.7690569, 46.5548385], [15.7687416, 46.5546787], [15.7677543, 46.5540286], [15.7670476, 46.5538534], [15.7654396, 46.5535763], [15.7640819, 46.5534774], [15.7628266, 46.5532255], [15.762434, 46.5531465], [15.760925, 46.5534175], [15.7598164, 46.5524802], [15.7593102, 46.5517189], [15.7585843, 46.5501672], [15.7584246, 46.5499344], [15.7578706, 46.5494882], [15.7567474, 46.5493607], [15.7557451, 46.5494933], [15.7542957, 46.549359], [15.7540074, 46.5492529], [15.7531993, 46.5492852], [15.7530024, 46.5491876], [15.7516246, 46.5495115], [15.751348, 46.5493154], [15.7510547, 46.5488495], [15.7504996, 46.5483134], [15.7503898, 46.5479182], [15.750468, 46.5479177], [15.7504708, 46.5471799], [15.7503133, 46.5471], [15.7504793, 46.546847], [15.7488948, 46.5463626], [15.7462176, 46.5451205], [15.7458873, 46.5438541], [15.7457014, 46.5436124], [15.7446062, 46.5426659], [15.7441138, 46.5419404], [15.7436152, 46.5417097], [15.7433202, 46.5414371], [15.7428228, 46.5409771], [15.7422893, 46.5400989], [15.742517, 46.5395846], [15.7429677, 46.5391768], [15.7428881, 46.5390784], [15.7421143, 46.5387415], [15.7413782, 46.5383054], [15.7401793, 46.5373865], [15.7387781, 46.5369368], [15.7382435, 46.5369312], [15.7379682, 46.5368161], [15.7373738, 46.5362531], [15.7371723, 46.5358136], [15.7371545, 46.5354628], [15.7375301, 46.5343178], [15.7375017, 46.5331843], [15.7369828, 46.5324139],
          [15.7365744, 46.5321017], [15.736317, 46.5313836], [15.7358785, 46.5307656], [15.734566, 46.5301083], [15.7339192, 46.5295187], [15.7336399, 46.5291066], [15.7332226, 46.5290913], [15.7320328, 46.528829], [15.7291768, 46.5287394], [15.7290099, 46.5289294], [15.7275839, 46.5295233], [15.7273648, 46.5297046], [15.7270529, 46.5297786], [15.7263803, 46.5301697], [15.7255207, 46.5302292], [15.723639, 46.5298902], [15.7240498, 46.5284391], [15.7239073, 46.5275223], [15.7233056, 46.5273642], [15.7222961, 46.5269298], [15.7216892, 46.5273655], [15.7206079, 46.5274083], [15.7200861, 46.5273846], [15.719537, 46.5272621], [15.7184944, 46.5272777], [15.7177662, 46.5274082], [15.7129457, 46.5276004], [15.7124931, 46.5258938], [15.7124262, 46.5247696], [15.7125685, 46.5236891], [15.7155612, 46.5143855], [15.7165333, 46.5120042], [15.7177637, 46.5094503], [15.7181846, 46.5087639], [15.7194923, 46.5071452], [15.720572, 46.5060227], [15.7212427, 46.5055057], [15.7220189, 46.5050779], [15.7233149, 46.5045569], [15.7242628, 46.5043079], [15.725082, 46.5041858], [15.7271532, 46.5041456], [15.7271247, 46.5039658], [15.7275645, 46.5037201], [15.7294817, 46.5028892], [15.7269676, 46.5029322], [15.7272973, 46.500303], [15.7284215, 46.499612], [15.7284325, 46.4994608], [15.7281712, 46.4994067], [15.7280566, 46.4996054], [15.7265351, 46.499813], [15.7260913, 46.4997528], [15.7253622, 46.4997935], [15.7247482, 46.4996714], [15.7242801, 46.4997374], [15.7228037, 46.5004035], [15.7227653, 46.5004577], [15.7236414, 46.5006951], [15.7241458, 46.5013937], [15.7239425, 46.5017818], [15.722968, 46.5029666], [15.7224516, 46.5033208], [15.7223158, 46.5038884], [15.7223961, 46.5040499], [15.7217749, 46.5043687], [15.720569, 46.5048082], [15.7171917, 46.5046135], [15.7162668, 46.5046283], [15.7156815, 46.504713], [15.7131411, 46.5057365], [15.7103608, 46.5073554], [15.7104071, 46.5079039], [15.7042963, 46.5079508], [15.704096, 46.5105971], [15.7036147, 46.5106631], [15.7035248, 46.5107626], [15.7026743, 46.5125132], [15.7025493, 46.5129189], [15.7025786, 46.5131706], [15.7020187, 46.51321], [15.7020268, 46.5133259], [15.7020347, 46.5134349], [15.7017289, 46.5139766], [15.7012767, 46.5152929], [15.700829, 46.5171169], [15.7003227, 46.5171072], [15.6986777, 46.5165661], [15.6980953, 46.5161851], [15.6975822, 46.5158104], [15.6957061, 46.5148412], [15.6927249, 46.5140676], [15.6917581, 46.5138755], [15.6909304, 46.5143754], [15.6894591, 46.5134486], [15.688788, 46.5139655], [15.6877236, 46.5143048], [15.6861043, 46.5150703], [15.6850602, 46.5159852], [15.6849291, 46.5159231], [15.6834713, 46.5176099], [15.6822802, 46.5174358], [15.6809784, 46.5170956], [15.6802337, 46.5169836], [15.677183, 46.5158928], [15.6766963, 46.5158111], [15.6757786, 46.5158626], [15.6723063, 46.5152771], [15.6701376, 46.514238], [15.6691952, 46.5137864], [15.6679061, 46.5133345], [15.6660823, 46.5128162], [15.663107, 46.511715], [15.6630265, 46.5117468], [15.6627245, 46.5137221], [15.6624117, 46.5143354], [15.6633209, 46.5145861], [15.6632163, 46.5148186], [15.6650367, 46.5153205], [15.664511, 46.5162328], [15.6619739, 46.5155098], [15.6612304, 46.5154601], [15.6611839, 46.5159192], [15.6607497, 46.5167791], [15.6591169, 46.516345], [15.6591805, 46.5162187], [15.6580029, 46.5158297], [15.6581305, 46.515604], [15.6548921, 46.5150738], [15.654764, 46.5152635], [15.6539803, 46.515115], [15.6532344, 46.515947], [15.6519315, 46.5156343], [15.6524929, 46.513882], [15.6526462, 46.512401], [15.6526285, 46.5109715], [15.6521961, 46.5108697], [15.6522591, 46.5106894], [15.6490984, 46.5100956], [15.6491364, 46.5100054], [15.6481824, 46.509777], [15.6465382, 46.5095794], [15.6449839, 46.5092733], [15.6445538, 46.5092667], [15.6410535, 46.5085847], [15.6411435, 46.5095918], [15.6410143, 46.5096825], [15.6395327, 46.5100147], [15.6381589, 46.5102573], [15.6378641, 46.5099611], [15.6372706, 46.5093523], [15.6369305, 46.5097795], [15.6359442, 46.5095939], [15.6353398, 46.5102811], [15.6346153, 46.510735], [15.6339623, 46.5107562], [15.6329063, 46.5106916], [15.6320712, 46.5104702], [15.6317847, 46.5104898], [15.6303302, 46.5109207], [15.6276573, 46.5107915], [15.6266905, 46.5105719], [15.6247469, 46.5104026], [15.6239461, 46.5110278], [15.6247606, 46.5115991], [15.6254537, 46.5118112], [15.6239157, 46.5117837], [15.6220546, 46.5119918], [15.6207648, 46.5120168], [15.6196526, 46.5127696], [15.619114, 46.5135373], [15.6187513, 46.5137282], [15.6182566, 46.5137758], [15.6179853, 46.5139842], [15.6177903, 46.5140213], [15.6173848, 46.5138885], [15.616646, 46.5130918], [15.616489, 46.5130386], [15.6163456, 46.5130394], [15.6159329, 46.5134195], [15.6154397, 46.5135931], [15.6138878, 46.5134935], [15.6133433, 46.5137484], [15.6127624, 46.5142373], [15.6122045, 46.5144563], [15.6112896, 46.5142272], [15.6108547, 46.5137977], [15.6104822, 46.5142766], [15.6101977, 46.514476], [15.6103063, 46.5148623], [15.6106757, 46.5152562], [15.6112772, 46.5154419], [15.6122994, 46.5159402], [15.6123939, 46.5162366], [15.6129229, 46.5169176], [15.613554, 46.517409], [15.613493, 46.5177782], [15.613611, 46.5178405], [15.6131469, 46.5182839], [15.6127626, 46.5188798], [15.6128792, 46.5199768], [15.6131999, 46.5206768], [15.6129943, 46.5209388], [15.6122433, 46.5213747], [15.6118671, 46.5215297], [15.6112689, 46.5216498], [15.6101942, 46.5211248], [15.6080359, 46.5204345], [15.6060977, 46.5196081], [15.6050932, 46.5195235], [15.6033695, 46.5192267], [15.6020921, 46.5192155], [15.6017525, 46.5191453], [15.6011237, 46.5188517], [15.59817, 46.5181115], [15.5975281, 46.517809], [15.5970945, 46.5174874], [15.5964399, 46.5172209], [15.5957574, 46.5167836], [15.5920242, 46.5162452], [15.5908387, 46.5161633], [15.5893635, 46.5160611],
          [15.5871943, 46.5155235], [15.5854341, 46.5154426], [15.5823397, 46.5149096], [15.5794197, 46.5148345], [15.5781436, 46.514931], [15.5773343, 46.5148091], [15.5764192, 46.5145438], [15.5747447, 46.5139405], [15.5728141, 46.5137613], [15.5706388, 46.5126206], [15.5683705, 46.5125419], [15.5674567, 46.5123935], [15.5651032, 46.5116405], [15.564765, 46.5116961], [15.5638299, 46.5107471], [15.5621255, 46.5097478], [15.5615076, 46.5092329], [15.5605632, 46.5098996], [15.560077, 46.5107657], [15.5579551, 46.5122516], [15.5549225, 46.5138948], [15.5522601, 46.5147895], [15.5484891, 46.5156174], [15.5480529, 46.5163033], [15.5483209, 46.5170307], [15.548071, 46.5180936], [15.5480995, 46.5183364], [15.5486046, 46.5193146], [15.549726, 46.5206497], [15.5498873, 46.5211348], [15.5497505, 46.5217832], [15.5494954, 46.5223423], [15.5489068, 46.5232691], [15.5503079, 46.5240568], [15.5518133, 46.5246973], [15.5523878, 46.5247844], [15.5529733, 46.5246826], [15.5529767, 46.5250155], [15.5527606, 46.5255564], [15.5517938, 46.5266227], [15.5517331, 46.5270638], [15.5520257, 46.5276382], [15.5513571, 46.5285412], [15.5509816, 46.5287949], [15.5508545, 46.5291104], [15.5509205, 46.5292], [15.5512206, 46.5292256], [15.5511451, 46.5294869], [15.5512, 46.5297655], [15.5518453, 46.5304102], [15.5516641, 46.530537], [15.5508972, 46.5307566], [15.5510814, 46.5309177], [15.5510931, 46.5320692], [15.5506601, 46.533079], [15.5505861, 46.5335022], [15.5509315, 46.5341393], [15.5510013, 46.5345888], [15.5514779, 46.5353063], [15.551977, 46.5356637], [15.5528652, 46.5358304], [15.5535238, 46.5364929], [15.5541788, 46.5368046], [15.5550876, 46.5376999], [15.5549609, 46.5380604], [15.5544816, 46.5383686], [15.5542286, 46.5391256], [15.5541457, 46.5399447], [15.5542817, 46.5404929], [15.5542654, 46.5414466], [15.5556328, 46.5425646], [15.5560828, 46.5432192], [15.5563648, 46.5440185], [15.5570899, 46.5447887], [15.5577774, 46.545703], [15.5586269, 46.5471654], [15.5586073, 46.5477952], [15.5579541, 46.548941], [15.5580318, 46.5501552], [15.5587435, 46.5508895], [15.558736, 46.5514293], [15.5584657, 46.5517726], [15.5576234, 46.5522985], [15.5575084, 46.552524], [15.557628, 46.5527393], [15.5578904, 46.552891], [15.5587407, 46.5531477], [15.5589378, 46.5532907], [15.5591124, 46.5537847], [15.5590132, 46.55428], [15.5593304, 46.5546923], [15.5596409, 46.5548365], [15.5605724, 46.5549831], [15.5594347, 46.5572199], [15.5596833, 46.5572907], [15.5590848, 46.5586971], [15.5584974, 46.5609736], [15.5582994, 46.5617411], [15.5548216, 46.561417], [15.5531133, 46.5614613], [15.5528518, 46.5629515], [15.5527702, 46.5636312], [15.5523112, 46.5646681], [15.5521225, 46.5653527], [15.551865, 46.5656869], [15.5511503, 46.5659512], [15.5510628, 46.5663295], [15.549775, 46.5666866], [15.5479766, 46.5668572], [15.5472873, 46.5670585], [15.5463258, 46.567441], [15.5454052, 46.5679942], [15.5443508, 46.5682151], [15.5432602, 46.5687332], [15.5430692, 46.5692019], [15.5437073, 46.5703864], [15.5438367, 46.5715824], [15.5442718, 46.5733437], [15.5441378, 46.5742872], [15.5463663, 46.57534], [15.5472942, 46.5754885], [15.5470771, 46.5759574], [15.5461494, 46.5771134], [15.5451025, 46.5780991], [15.543733, 46.5781506], [15.5426551, 46.5786506], [15.5406916, 46.5806392], [15.5416727, 46.582191], [15.5418735, 46.5827029], [15.542071, 46.5828729], [15.5426941, 46.5838596], [15.5436048, 46.5848899], [15.5444321, 46.5854077], [15.5459613, 46.5856523], [15.5470791, 46.5865017], [15.5482446, 46.5881965], [15.5486351, 46.5893912], [15.5490198, 46.5900101], [15.5496905, 46.5905197], [15.5491341, 46.5909812], [15.5488221, 46.5911087], [15.5484967, 46.5911912], [15.5473881, 46.5912595], [15.546308, 46.5915616], [15.5456061, 46.5918438], [15.5447064, 46.5919201], [15.5422924, 46.5932542], [15.5404974, 46.5938565], [15.5397539, 46.593905], [15.5388867, 46.5933153], [15.5381916, 46.5929857], [15.5371571, 46.5926307], [15.5365954, 46.5925794], [15.5356174, 46.5926649], [15.5344329, 46.5929764], [15.5331927, 46.5929462], [15.5321372, 46.5931041], [15.5316446, 46.5934393], [15.5313844, 46.5935214], [15.5309342, 46.5935325], [15.5294063, 46.5940974], [15.5287587, 46.5946133], [15.5281413, 46.5955428], [15.5281257, 46.5966135], [15.527985, 46.596911], [15.5276359, 46.5972455], [15.5270904, 46.597527], [15.5257633, 46.597956], [15.5241474, 46.5982243], [15.5245276, 46.5983935], [15.5255661, 46.5991534], [15.526535, 46.5994639], [15.5266021, 46.5996525], [15.5242726, 46.600365], [15.5234893, 46.6003596], [15.5230176, 46.6001728], [15.5228089, 46.6001828], [15.5216635, 46.6005209], [15.5206731, 46.6006874], [15.5215909, 46.601115], [15.5224458, 46.6017859], [15.5227234, 46.6021445], [15.5230236, 46.6034926], [15.5221418, 46.6040994], [15.5188737, 46.604969], [15.5176485, 46.6051635], [15.5169925, 46.6061832], [15.5172295, 46.606398], [15.5185996, 46.6063378], [15.5195161, 46.6066215], [15.5199601, 46.6066375], [15.5205474, 46.6066168], [15.5210288, 46.6064527], [15.5222014, 46.6062224], [15.5235845, 46.6061531], [15.524042, 46.6062139], [15.5237492, 46.606989], [15.5228836, 46.6079197], [15.5220716, 46.609003], [15.522327, 46.6097666], [15.5230522, 46.61051], [15.5231728, 46.6108333], [15.5250216, 46.613002], [15.5259801, 46.6135644], [15.5244379, 46.6133916], [15.5239291, 46.6134299], [15.522822, 46.6137049], [15.5218702, 46.6138352], [15.5211417, 46.6141084], [15.5207606, 46.6152168], [15.5206764, 46.6159639], [15.5207754, 46.6167552], [15.5209622, 46.6171682], [15.5209522, 46.6174831], [15.5203835, 46.6180885], [15.5203097, 46.6185566], [15.5205492, 46.6190234], [15.5203871, 46.6198158], [15.5204748, 46.6207961], [15.5201295, 46.6215512]]]).transform('EPSG:4326', 'EPSG:3857')
        });

        vectorSourcePoly.addFeature(featureTe);*/

        //================NEW MAP================

        var map = new ol.Map({
          target: 'map',
          layers: [
            new ol.layer.Tile({
              source: new ol.source.OSM()
            }),
            vectorLayer,
            vectorUserLocation,
            vectorPoly
          ],
          controls: ol.control.defaults({
            attribution: false
          }),
          view: new ol.View({
            center: ol.proj.fromLonLat([14.5058, 46.0569]),
            zoom: 7
          })
        });

        /*
                const element = document.getElementById('popup');
        
                const popup = new ol.Overlay({
                  element: element,
                  positioning: 'bottom-center',
                  stopEvent: false,
                });
                map.addOverlay(popup);
        
                map.on('click', function (evt) {
                  const feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
                    return feature;
                  });
                  if (feature) {
                    popup.setPosition(evt.coordinate);
                    $(element).popover({
                      placement: 'top',
                      html: true,
                      content: feature.get('name'),
                    });
                    $(element).popover('show');
                  } else {
                    $(element).popover('dispose');
                  }
                });
        */
        view = new ol.View({
          center: [0, 0],
          zoom: 2,
          setBuiltInZoom: false
        });

        function el(id) {
          return document.getElementById(id);
        }

        var stylesTest = {
          route: new ol.style.Style({
            stroke: new ol.style.Stroke({
              width: 6, color: [40, 40, 40, 0.8]
            })
          }),
          icon: new ol.style.Style({
            image: new ol.style.Icon({
              anchor: [0.5, 1],
              src: 'https://i.imgur.com/CEOIJvx.png',
              scale: 0.08
            })
          })
        };

        //================CREATE WAYPOINT================

        /*map.on('click', function (evt) {
          if (mode == 0) {
            if (points.length == 1) {
              utils.getNearest(evt.coordinate).then(function (coord_street) {
                var last_point = points[points.length - 1];
                var points_length = points.push(coord_street);
                vectorLayer.getSource().clear();
                utils.createFeature(last_point);
                utils.createFeature(coord_street);

                var point1 = last_point.join();
                var point2 = coord_street.join();

                fetch(url_osrm_route + point1 + ';' + point2).then(function (r) {
                  return r.json();
                }).then(function (json) {
                  if (json.code !== 'Ok') {
                    return;
                  }
                  points.length = 0;
                  utils.createRoute(json.routes[0].geometry);
                });
              });
            } else {
              utils.getNearest(evt.coordinate).then(function (coord_street) {
                vectorLayer.getSource().clear();
                utils.createFeature(coord_street);
                points.push(coord_street)
              });
            }
          }
          if (mode == 1) {
            utils.getNearest(evt.coordinate).then(function (coord_street) {
              vectorLayer.getSource().clear();
              utils.createFeature(coord_street);

              var point1 = userLonLat.join();
              var point2 = coord_street.join();

              fetch(url_osrm_route + point1 + ';' + point2).then(function (r) {
                return r.json();
              }).then(function (json) {
                if (json.code !== 'Ok') {
                  return;
                }
                points.length = 0;
                utils.createRoute(json.routes[0].geometry);
              });
            });
          }
        });*/

        //================UTILITIES================

        var utils2 = {
          showLocation: function (coord) {
            var feature = new ol.Feature({
              type: 'place',
              geometry: new ol.geom.Point(ol.proj.fromLonLat(coord))
            });
            vectorSource2.addFeature(feature);
          }
        };

        //================USE LOCATION CHECKBOX================

        var checkbox = document.querySelector("input[id=useLocation]");
        checkbox.addEventListener('change', function () {
          if (this.checked) {
            mode = 1;
            $('#startLoc').addClass('disabled');
            new Geolocation().showPosition()
          } else {
            mode = 0;
            $('#startLoc').removeClass('disabled');
            vectorUserLocation.getSource().clear();
          }
          points = [];
          vectorLayer.getSource().clear();
        });

        function turnOnLocation() {
          mode = 1;
          $('#startLoc').addClass('disabled');
          new Geolocation().showPosition()
          checkbox.checked = true;
        }

        //================TRACKING================

        class Geolocation {
          successCallback(position) {
            userLonLat[0] = position.coords.longitude;
            userLonLat[1] = position.coords.latitude;
            utils2.showLocation(userLonLat);
          }
          errorCallback(error) {
            if (error.code == 1) {
              alert("You have not given permission to access your location.")
            } else if (error.code == 2) {
              alert(result.innerText = "Your location is unavailable.")
            } else if (error.code == 3) {
              alert(result.innerText = "The request to get your location timed out.")
            } else {
              alert(result.innerText = "An unknown error occurred.")
            }
          }
          showPosition() {
            if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(
                this.successCallback,
                this.errorCallback
              )
            } else {
              alert('Your browser does not support geolocation')
            }
          }
        }



        // http://polygons.openstreetmap.fr/get_geojson.py?id=1676350&params=0

        turnOnLocation();







        var checkbox = document.querySelector("a[id=search]");
        checkbox.addEventListener('click', function () {

        });





      </script>





      <div class="list no-hairlines">
        <ul>
          <li>
            <div class="item-inner item-cell">
              <div class="item-row">
                <div class="item-cell">
                  <div class="item-content item-input item-input-outline">
                    <div class="item-inner">
                      <div class="item-title item-floating-label">Starting location</div>
                      <div id="startLoc" class="item-input-wrap">
                        <input type="text" id="startLocation" placeholder="Starting location" />
                        <span class="input-clear-button"></span>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="item-cell" style="width: 20%;">
                  <label class="toggle toggle-init color-blue">
                    <input type="checkbox" id="useLocation" />
                    <span class="toggle-icon"></span>
                  </label>
                </div>
              </div>
              <div class="item-row">
                <div class="item-cell">
                  <div class="item-content item-input item-input-outline">
                    <div class="item-inner">
                      <div class="item-title item-floating-label">Destination</div>
                      <div class="item-input-wrap">
                        <input type="text" id="destination" placeholder="Destination" />
                        <span class="input-clear-button"></span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="block segmented login-button-color">
                <a href="#" id="search" @click=${findPath}
                  class=" item-link button button-preloader button-fill open-full">Search</a>
              </div>
              <div class="block segmented login-button-color">
                <a href="/form/" id="createMarker" class="button button-raised button-fill login-screen-open">Create
                  marker</a>
              </div>
            </div>
          </li>
        </ul>
      </div>





      <!--<div class="block-title">Navigation</div>
      <div class="list">
        <ul>
          <li>
            <a href="/about/" class="item-content item-link">
              <div class="item-inner">
                <div class="item-title">
                  Information
                </div>
              </div>
            </a>
          </li>
          <li>
            <a href="/form/" id="createMarker" class="item-content item-link">
              <div class="item-inner">
                <div class="item-title">
                  Create marker
                </div>
              </div>
            </a>
          </li>
        </ul>
      </div>
      <div class="block-title">Modals</div>
      <div class="block block-strong">
        <div class="row">
          <div class="col-50">
            <a href="#" class="button button-raised button-fill popup-open" data-popup="#my-popup">Popup</a>
          </div>
          <div class="col-50">
            <a href="#" class="button button-raised button-fill login-screen-open"
              data-login-screen="#my-login-screen">Login Screen</a>
          </div>
        </div>
      </div>

      <div class="block-title">Panels</div>
      <div class="block block-strong">
        <div class="row">
          <div class="col-50">
            <a href="#" class="button button-raised button-fill panel-open" data-panel="left">Left Panel</a>
          </div>
          <div class="col-50">
            <a href="#" class="button button-raised button-fill panel-open" data-panel="right">Right Panel</a>
          </div>
        </div>
      </div>

      <div class="list links-list">
        <ul>
          <li>
            <a href="/dynamic-route/blog/45/post/125/?foo=bar#about">Dynamic (Component) Route</a>
          </li>
          <li>
            <a href="/load-something-that-doesnt-exist/">Default Route (404)</a>
          </li>
          <li>
            <a href="/request-and-load/user/123456/">Request Data & Load</a>
          </li>
        </ul>
      </div>-->
    </div>
  </div>
</template>

<script>
  export default function (props, { $, $f7, $on, $onBeforeMount, $onMounted, $onBeforeUnmount, $onUnmounted }) {
    // Component Data
    let name = 'Jimmy';
    let age = 25;
    let likes = ['Tennis', 'Chess', 'Football'];
    let notifyMessage = { author: 'Miha', content: 'testno sporocilo' };

    var notificationFull = $f7.notification.create({
      icon: '<i class="icon demo-icon">7</i>',
      title: 'EK maps',
      titleRightText: 'now',
      subtitle: notifyMessage.author,
      text: notifyMessage.content,
      closeTimeout: 3000,
    });

    // Component Methods
    const findPath = () => {
      notificationFull.open();
      if (document.getElementById("useLocation").checked == true) {
        $f7.request.get('https://nominatim.openstreetmap.org/search.php?q=' +
          document.getElementById("destination").value + '&format=json')
          .then(function (res) {
            var data = JSON.parse(res.data)[0];
            var location = new Array(2);
            $f7.request.get('https://nominatim.openstreetmap.org/search.php?q=' + document.getElementById("destination").value +
              '&polygon_geojson=1&format=json').then(function (response) {
                var polygonData = JSON.parse(response.data);
                var featurePoly = new ol.Feature({
                  type: 'place',
                  geometry: new ol.geom.Polygon(polygonData[0].geojson.coordinates).transform('EPSG:4326', 'EPSG:3857')
                });
                vectorPoly.getSource().clear();
                vectorSourcePoly.addFeature(featurePoly);
                location[0] = data.lon;
                location[1] = data.lat;
                $f7.request.get('https://router.project-osrm.org/nearest/v1/driving/' + location.join()).then(function (response) {
                  var data2 = JSON.parse(response.data);
                  vectorLayer.getSource().clear();
                  utils.createFeature(data2.waypoints[0].location);
                  var point1 = userLonLat.join();
                  var point2 = data2.waypoints[0].location.join();
                  fetch('https://router.project-osrm.org/route/v1/driving/' + point1 + ';' + point2)
                    .then(function (r) {
                      return r.json();
                    })
                    .then(function (json) {
                      if (json.code !== 'Ok') {
                        return;
                      }
                      utils.createRoute(json.routes[0].geometry);

                      var stylesTest2 = {
                        route: new ol.style.Style({
                          stroke: new ol.style.Stroke({
                            width: 6, color: [40, 40, 40, 0.8]
                          })
                        }),
                        icon: new ol.style.Style({
                          image: new ol.style.Icon({
                            anchor: [0.5, 1],
                            src: 'https://i.imgur.com/F4jjvFQ.png',
                            scale: 0.08
                          })
                        })
                      };

                      var feature2 = new ol.Feature({
                        type: 'place',
                        geometry: new ol.geom.Point(ol.proj.fromLonLat([15.4389, 46.3055]))
                      });
                      feature2.setStyle(stylesTest.icon);
                      vectorSource.addFeature(feature2);

                      var feature2 = new ol.Feature({
                        type: 'place',
                        geometry: new ol.geom.Point(ol.proj.fromLonLat([15.8060, 46.4560]))
                      });
                      feature2.setStyle(stylesTest.icon);
                      vectorSource.addFeature(feature2);

                      var feature2 = new ol.Feature({
                        type: 'place',
                        geometry: new ol.geom.Point(ol.proj.fromLonLat([15.6716, 46.4384]))
                      });
                      feature2.setStyle(stylesTest2.icon);
                      vectorSource.addFeature(feature2);
                    });
                }).catch(function (err) {
                  alert("findpath error: " + err.xhr)
                  alert(err.status)
                  alert(err.message)
                })
              }).catch(function (err) {
                alert("findpath2 error: " + err.xhr)
                alert(err.status)
                alert(err.message)
              })
          }).catch(function (err) {
            alert("findpath3 error: " + err.xhr)
            alert(err.status)
            alert(err.message)
          })
      } else {
        var location1 = new Array(2);
        var location2 = new Array(2);
        $f7.request.get('https://nominatim.openstreetmap.org/search.php?q=' + document.getElementById("startLocation").value + '&format=json')
          .then(function (res) {
            var data1 = JSON.parse(res.data)[0];
            location1[0] = data1.lon;
            location1[1] = data1.lat;
            $f7.request.get('https://nominatim.openstreetmap.org/search.php?q=' + document.getElementById("destination").value + '&format=json')
              .then(function (res) {
                var data2 = JSON.parse(res.data)[0];
                location2[0] = data2.lon;
                location2[1] = data2.lat;

                $f7.request.get('https://router.project-osrm.org/nearest/v1/driving/' + location1.join()).then(function (coord_street1) {
                  $f7.request.get('https://router.project-osrm.org/nearest/v1/driving/' + location2.join()).then(function (coord_street2) {
                    vectorLayer.getSource().clear();
                    var data1 = JSON.parse(coord_street1.data);
                    var data2 = JSON.parse(coord_street2.data);
                    utils.createFeature(data1.waypoints[0].location);
                    utils.createFeature(data2.waypoints[0].location);

                    var point1 = data1.waypoints[0].location.join();
                    var point2 = data2.waypoints[0].location.join();
                    fetch('https://router.project-osrm.org/route/v1/driving/' + point1 + ';' + point2)
                      .then(function (r) {
                        return r.json();
                      })
                      .then(function (json) {
                        if (json.code !== 'Ok') {
                          return;
                        }
                        utils.createRoute(json.routes[0].geometry);
                      });
                  })
                })


              }).catch(function (err) {
                console.log(err.xhr)
                console.log(err.status)
                console.log(err.message)
              })
          }).catch(function (err) {
            console.log(err.xhr)
            console.log(err.status)
            console.log(err.message)
          })


      }
    }

    var utils = {
      getNearest: function (coord) {
        $f7.request.get('https://router.project-osrm.org/nearest/v1/driving/' +
          coord.join()).then(function (response) {
            var data = JSON.parse(response.data);
            return data.waypoints[0].location;
          });

      },
      createFeature: function (coord) {
        var feature = new ol.Feature({
          type: 'place',
          geometry: new ol.geom.Point(ol.proj.fromLonLat(coord))
        });
        feature.setStyle(styles.icon);
        vectorSource.addFeature(feature);
      },
      createRoute: function (polyline) {
        var route = new ol.format.Polyline({
          factor: 1e5
        }).readGeometry(polyline, {
          dataProjection: 'EPSG:4326',
          featureProjection: 'EPSG:3857'
        });
        var feature = new ol.Feature({
          type: 'route',
          geometry: route
        });
        feature.setStyle(styles.route);
        vectorSource.addFeature(feature);
      },
      showLocation: function (coord) {
        var feature = new ol.Feature({
          type: 'place',
          geometry: new ol.geom.Point(ol.proj.fromLonLat(coord))
        });
        vectorSource2.addFeature(feature);
      }
    };

    <p><a class="button button-fill pb-standalone" href="#">...</a></p>


    return $render;
  }
</script>[]